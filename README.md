# プロジェクト概要

このプロジェクトは、OpenCV と Mediapipe を利用したジェスチャー認識によるインタラクティブゲームです。プレイヤーはカメラに映る自分の手の動きで画面上のターゲットに触れてスコアを獲得します。ゲームは複数のステージで構成され、各ステージで異なるルールが適用されます。

# 技術スタック

-   **プログラミング言語:** Python
-   **メインライブラリ:**
    -   OpenCV (`cv2`): カメラからの映像取得、画像処理、ウィンドウ表示、UI要素（テキスト、図形）の描画に使用されます。
    -   Mediapipe (`mediapipe`): リアルタイムでの姿勢推定（特に手の位置検出）に使用されます。
-   **音楽・効果音再生:**
    -   `Music/bgm.py` で実装されており、おそらく `pygame.mixer` または同様のライブラリがBGMおよび効果音の再生に使用されていると推測されます。
-   **その他:**
    -   `numpy`: 数値計算、特に座標計算などで内部的に使用されることがあります。

# ディレクトリ構成とファイル説明

## ルートディレクトリ

-   **`main.py`**:
    -   ゲーム全体の進行管理（メインループ）。
    -   各シーン（スタート、カウントダウン、ステージ1・2・3、スコア表示、終了）の呼び出しと遷移を制御します。
    -   BGM および効果音の再生タイミングを管理します。
-   **`setting.py`**:
    -   カメラ設定（解像度、使用するカメラのID）。
    -   ウィンドウ設定（ウィンドウ名、表示モード）。
    -   ゲーム内で共通して使用される定数（例: 当たり判定の半径、画面中央座標など）を定義します。
-   **`start.py`**:
    -   スタート画面の表示ロジック。
    -   Mediapipe を使用して手のジェスチャー（特定エリアへのタッチ）を検出し、ゲーム開始操作を処理します。
    -   ローディングアニメーション（`Movie/loading.mp4`）の表示機能を含みます。
-   **`score.py`**:
    -   スコアの保存処理（`scores.txt` へ書き込み）。
    -   ハイスコアおよび最終スコアの読み込みと画面表示。
    -   スコア表示画面でのリスタートまたは終了の選択を、手のジェスチャーによって操作する機能を提供します。
-   **`scores.txt`**:
    -   プレイヤーのスコアが一行ごとに記録されるテキストファイル。
-   **`finish_scene.py`**:
    -   ゲーム終了時に「FINISH」というテキストアニメーションを表示します。
-   **`README.md`**:
    -   このファイル。プロジェクトの概要、技術スタック、ファイル構成、セットアップ手順などを記載。
-   **`check.py`**:
    -   このファイルの具体的な機能は、内容を確認するまで不明です。

## `Countdown/` ディレクトリ

-   **`countdown_main.py`**:
    -   スタート画面からゲームステージへ移行する際のカウントダウンシーケンス全体を管理します。
    -   `space.py`, `countdown3.py`, `countdown2.py`, `countdown1.py`, `countdown_start.py` を順に呼び出してカウントダウンアニメーションを構成します。
    -   カウントダウン効果音（`Music/countdown.mp3`）の再生をトリガーします。
-   **`countdown_start.py`**: カウントダウンの「START」表示部分を担当。
-   **`countdown1.py`**: カウントダウンの「1」表示部分を担当。
-   **`countdown2.py`**: カウントダウンの「2」表示部分を担当。
-   **`countdown3.py`**: カウントダウンの「3」表示部分を担当。
-   **`space.py`**: カウントダウンシーケンス開始前のブランク画面または準備画面を担当。

## `Game/` ディレクトリ

-   **`avater.py`**:
    -   Mediapipe で検出された姿勢ランドマークに基づいて、プレイヤーのアバター（例: 骨格線）を画面に描画する役割を担っていると推測されます。
-   **`stage1.py`**:
    -   ゲームステージ1のメインロジック。
    -   ランダムな位置に出現する単一のターゲット（金色）に手で触れるとスコアが加算されます。
    -   制限時間、スコア計算、ターゲットの生成と管理を行います。
-   **`stage1_scene.py`**:
    -   ステージ1開始前に、ステージ名やルールなどの導入情報を表示する画面と推測されます。
-   **`stage2.py`**:
    -   ゲームステージ2のメインロジック。
    -   指定された色（赤または青）のターゲットに、対応する手（右手で赤、左手で青）で触れるとスコアが加算されます。
-   **`stage2_scene.py`**:
    -   ステージ2開始前に、ステージ名やルールなどの導入情報を表示する画面と推測されます。
-   **`stage3.py`**:
    -   ゲームステージ3のメインロジック。
    -   赤、青、または金色のターゲットが出現。赤は右手、青は左手、金色はどちらの手でも触れるとスコアが加算されます。
    -   ターゲットは一定時間（2秒）で再配置されます。
    -   ゲーム後半ではスコアが「???」と表示される演出があります。
-   **`stage3_scene.py`**:
    -   ステージ3開始前に、ステージ名やルールなどの導入情報を表示する画面と推測されます。

## `Movie/` ディレクトリ

-   **`loading.mp4`**:
    -   `start.py` でゲーム開始時に表示されるローディングアニメーション用の動画ファイル。

## `Music/` ディレクトリ

-   **`bgm.py`**:
    -   BGM および効果音の再生、停止、初期化などのサウンド関連処理を管理するモジュールと推測されます。
-   **`countdown.mp3`**: カウントダウンシーケンス中に再生される効果音。
-   **`Finish_SE.mp3`**: ゲーム終了（`finish_scene.py`）時に再生される効果音。
-   **`free1.mp3`**: ゲームプレイ中に使用されるBGM。
-   **`free2.mp3`**: スタート画面やスコア画面など、メニュー系画面で使用されるBGM。
-   **`SE1.mp3`, `SE2.mp3`**: 画面遷移時や特定の操作時に使用される効果音。

## `__pycache__/` ディレクトリ

-   Python のコンパイル済みバイトコード (`.pyc` ファイル) が自動的に保存されるディレクトリです。これにより次回以降のスクリプト実行が若干速くなることがあります。このディレクトリは削除しても問題ありません（Python実行時に再生成されます）。

# 環境構築と注意点

-   **Python:** 必須です (開発時バージョン例: Python 3.11.3 など、3.9以上を推奨)。
-   **必須ライブラリのインストール:**
    ```bash
    pip install opencv-python mediapipe numpy
    ```
    `Music/bgm.py` の実装によっては `pygame` など追加のライブラリが必要になる場合があります。
    ```bash
    pip install pygame # 必要に応じて
    ```
-   **カメラ設定:**
    -   `setting.py` 内の `cap = cv2.VideoCapture(1)` の数値 `1` は、使用するカメラのIDです。お使いのPC環境や接続されているカメラの数によって、このIDは `0`, `2` などに変更する必要がある場合があります。通常、内蔵カメラは `0`、USB接続の外部カメラは `1` 以降の番号が割り当てられます。
-   **ファイルパスの確認:**
    -   `main.py`、`start.py`、`Countdown/countdown_main.py` 内でBGM、効果音、動画ファイルのパスがハードコードされています (例: `c:/Users/Public/Documents/OC_game/...`)。これらのパスは、実行する環境の実際のファイル場所に合わせて修正する必要があります。プロジェクトルートからの相対パスを使用するように変更することを推奨します。
-   **ウィンドウサイズ:**
    -   `setting.py` でカメラ解像度が `1920x1080` に設定されています。これより低い解像度のディスプレイやカメラを使用する場合、表示に問題が生じるか、パフォーマンスに影響が出る可能性があります。
